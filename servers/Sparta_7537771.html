<!--
title: Sparta
description: 
published: true
date: 2022-04-21T13:06:18.465Z
tags: 
editor: ckeditor
dateCreated: 2022-04-21T13:06:16.551Z
-->

                    <div class="contentLayout2">
<div class="columnLayout two-equal" data-layout="two-equal">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<h3 id="Sparta-SystemDetails">System Details</h3><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col><col></colgroup><tbody><tr><td colspan="1" class="confluenceTd">System Role</td><td colspan="1" class="confluenceTd">IDS / Networking Logging after FW</td></tr><tr><td colspan="1" class="confluenceTd">Hardware Type</td><td colspan="1" class="confluenceTd">Physical</td></tr><tr><td class="confluenceTd">Operating System</td><td class="confluenceTd"><span>Centos 7.4 1708</span></td></tr><tr><td class="confluenceTd">Network</td><td class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Ipaddress</td><td colspan="1" class="confluenceTd">216.229.224.86</td></tr><tr><td colspan="1" class="confluenceTd">System Owner</td><td colspan="1" class="confluenceTd">Luke</td></tr><tr><td colspan="1" class="confluenceTd">Contracts</td><td colspan="1" class="confluenceTd">emergingthreats pro</td></tr></tbody></table></div><h3 id="Sparta-ApplicationNotes">Application Notes</h3><ul><li>Splunk Forwarder listening to Suricata events</li><li>Suricata listening on p2p1</li><li>Oinkmaster to update Suricata rules with EmergingThreats Pro signatures</li><li>Bro listening on p1p2 and logging traffic. Retains logs for 28 days.</li><li>ntopng listening on p2p1 (free edition)</li></ul><p> </p></div>
</div>
<div class="cell normal" data-type="normal">
<div class="innerCell">
<h3 id="Sparta-SystemMaintenance">System Maintenance</h3><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col><col></colgroup><tbody><tr><td class="confluenceTd">Maintenance Window</td><td class="confluenceTd">anytime</td></tr></tbody></table></div><h3 id="Sparta-MaintenanceNotes">Maintenance Notes</h3><ul><li>yum update anytime</li><li>start suricata 'suricata -c /etc/suricata/suricata.yaml -v --af-packet=p2p1'</li><li>kill -USR2 $(suricata pid) to reload rules after manual update</li><li>update rules with 'oinkmaster.pl -o /etc/suricata/rules'</li><li>to start bro: type &quot;./broctl&quot; then &quot;start&quot;</li><li>To restart/start ntopng 'start/enable redis.service then ntopng.service'</li></ul><p><strong>Software Packages</strong></p><ul><li><a href="https://www.bro.org/index.html" class="external-link" rel="nofollow">https://www.bro.org/index.html</a></li><li><a rel="nofollow" class="external-link" href="https://suricata-ids.org/">https://suricata-ids.org/</a></li><li><a class="external-link" href="http://suricata.readthedocs.io/en/latest/what-is-suricata.html" rel="nofollow">http://suricata.readthedocs.io/en/latest/what-is-suricata.html</a></li><li><a class="external-link" href="http://oinkmaster.sourceforge.net/" rel="nofollow">http://oinkmaster.sourceforge.net/</a></li><li><a href="http://docs.splunk.com/Documentation/Forwarder/6.5.1/Forwarder/Installanixuniversalforwarder#Install_the_universal_forwarder_on_Linux" class="external-link" rel="nofollow">http://docs.splunk.com/Documentation/Forwarder/6.5.1/Forwarder/Installanixuniversalforwarder#Install_the_universal_forwarder_on_Linux</a></li></ul><p><br></p><p><strong>Work Notes</strong></p><ul><li>Bro logs at /usr/local/bro/logs</li><li>Suricata Logs<ul><li>threshold.config at /etc/suricata/</li><li>rules at /etc/suricata/rules</li><li>traffic logs /var/log/suricata</li><li>alert logs var/log/suricata</li><li>suricata.yaml /etc/suricata</li></ul></li></ul></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<h3 id="Sparta-RelatedInformation">Related Information</h3><p><a class="createlink" href="/pages/createpage.action?spaceKey=NET&amp;title=Diagram+of+Core+Security+Infrastructure">Diagram of Core Security Infrastructure</a></p><p></p></div>
</div>
</div>
</div>
                    